<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æœºå™¨å­¦ä¹ _facebookç­¾åˆ°é¢„æµ‹</title>
      <link href="/2022/10/06/facebook_%E7%AD%BE%E5%88%B0%E5%9C%B0%E7%82%B9%E9%A2%84%E6%B5%8B/"/>
      <url>/2022/10/06/facebook_%E7%AD%BE%E5%88%B0%E5%9C%B0%E7%82%B9%E9%A2%84%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Facebookç­¾åˆ°åœ°ç‚¹é¢„æµ‹æ¡ˆä¾‹"><a href="#Facebookç­¾åˆ°åœ°ç‚¹é¢„æµ‹æ¡ˆä¾‹" class="headerlink" title="Facebookç­¾åˆ°åœ°ç‚¹é¢„æµ‹æ¡ˆä¾‹"></a>Facebookç­¾åˆ°åœ°ç‚¹é¢„æµ‹æ¡ˆä¾‹</h1><p>ç”±äºæ­¤æ¬¡å¤„ç†çš„æ•°æ®æ¯”è¾ƒå¤šï¼Œå°±æŠŠç¯å¢ƒæ¢æˆäº†jupyterï¼Œæ¯è¡Œæ‰§è¡Œå®Œéƒ½èƒ½çœ‹åˆ°ç»“æœ</p><h2 id="è·å–æ•°æ®"><a href="#è·å–æ•°æ®" class="headerlink" title="è·å–æ•°æ®"></a>è·å–æ•°æ®</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.read_csv(<span class="string">&quot;./FBlocation/train.csv&quot;</span>) <span class="comment">#ç›¸å¯¹è·¯å¾„è·å–æ•°æ®</span></span><br></pre></td></tr></table></figure><h2 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><p>ç”±äºæ­¤æ–‡ä»¶æ•°æ®é‡è¿‡äºåºå¤§ï¼Œéœ€è¦é€‚å½“å¤„ç†æ•°æ®</p><p>å…ˆæŸ¥çœ‹å¾—åˆ°çš„æ•°æ®</p><p><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/fb_original_data.png"></p><ol><li>è¯•ç€ç¼©å°æ•°æ®èŒƒå›´</li></ol><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = data.query(<span class="string">&quot;x &lt; 10 &amp; x &gt; 2 &amp; y &lt; 10 &amp; y &gt; 1.0&quot;</span>) <span class="comment"># å°†xå’Œyå›ºå®šåœ¨ä¸€å®šèŒƒå›´å†…ï¼Œè™½ç„¶è¿™é‡Œçš„èŒƒå›´æ˜¯éšä¾¿è®¾çš„</span></span><br></pre></td></tr></table></figure><ol start="2"><li>å¤„ç†æ—¶é—´ç‰¹å¾</li></ol><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time_value = pd.to_datetime(data[<span class="string">&quot;time&quot;</span>],unit=<span class="string">&quot;s&quot;</span>) </span><br></pre></td></tr></table></figure><p>æ­¤æ—¶time_valueæ˜¯</p><p><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/fb_time_value.png"></p><p>å†ç”¨dateæ¥æ”¶pd.DatetimeIndex(time_value)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date = pd.DatetimeIndex(time_value) <span class="comment"># å°†æ—¶é—´æŒ‰å¹´æœˆæ—¥æ—¶åˆ†å¦™æŒ‰åºåˆ—å½¢å¼å­˜èµ·æ¥</span></span><br></pre></td></tr></table></figure><p>åˆ™å¯ä»¥ç›´æ¥é€šè¿‡date[â€œhourâ€]è®¿é—®å…¶å†…å®¹</p><p>è§‚å¯Ÿå‘ç°ï¼Œå¹´ä»½éƒ½æ˜¯1970ï¼Œæœˆä»½éƒ½æ˜¯1æœˆï¼Œå±äºæ— æ•ˆæ•°æ®ï¼Œæ­¤å¤„å–å¾—æ—¥æœŸï¼Œæ˜ŸæœŸï¼Œå’Œå°æ—¶ä½œä¸ºåˆ¤æ–­æ•°æ®åŠ å…¥åŸdata</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&quot;day&quot;</span>] = date.day</span><br><span class="line">data[<span class="string">&quot;weekday&quot;</span>] = date.weekday</span><br><span class="line">data[<span class="string">&quot;hour&quot;</span>] = date.hour</span><br></pre></td></tr></table></figure><p>åˆ™å¾—åˆ°äº†ç­›é€‰åçš„data</p><p><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/fb_after_data.png"></p><ol start="3"><li>è¿‡æ»¤æ‰ç­¾åˆ°åœ°ç‚¹è¾ƒå°‘çš„åœ°ç‚¹ï¼Œå³ä¸éœ€è¦ä»–ä»¬çš„place_id</li></ol><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">place_count = data.groupby(<span class="string">&quot;place_id&quot;</span>).count()[<span class="string">&quot;row_id&quot;</span>] </span><br><span class="line"><span class="comment"># ç»Ÿè®¡æ¯ä¸ªplace_idå‡ºç°çš„æ¬¡æ•°ï¼Œå†å–ä»–ä»¬çš„è¡Œåºå·æ”¾åˆ°place_count</span></span><br><span class="line">data_final = data[data[<span class="string">&quot;place_id&quot;</span>].isin(place_count[place_count &gt; <span class="number">3</span>].index.values)]</span><br><span class="line"><span class="comment"># place_count[place_count &gt; 3]å°†place_idå‡ºç°æ¬¡æ•°å¤§äº3çš„place_idçº³å…¥æµ‹è¯•èŒƒå›´ï¼Œå°†èŒƒå›´å†…çš„dataæ•°æ®æ”¾å…¥data_final</span></span><br></pre></td></tr></table></figure><p>place_count[place_count &gt; 3]å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/fb_place_count-3.png"></p><p>data_finalå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/fb.data_final.png"></p><h1 id="ç­›é€‰ç‰¹å¾å€¼å’Œç›®æ ‡å€¼"><a href="#ç­›é€‰ç‰¹å¾å€¼å’Œç›®æ ‡å€¼" class="headerlink" title="ç­›é€‰ç‰¹å¾å€¼å’Œç›®æ ‡å€¼"></a>ç­›é€‰ç‰¹å¾å€¼å’Œç›®æ ‡å€¼</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = data_final[[<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;accuracy&quot;</span>, <span class="string">&quot;day&quot;</span>, <span class="string">&quot;weekday&quot;</span>, <span class="string">&quot;hour&quot;</span>]]</span><br><span class="line">y = data_final[<span class="string">&quot;place_id&quot;</span>]</span><br><span class="line"><span class="comment"># ç¡®å®šxå’Œyçš„å†…å®¹</span></span><br></pre></td></tr></table></figure><p>xä¸ºè¢«è®¤ä¸ºæœ‰å½±å“çš„å‡ ä¸ªå› ç´ ï¼Œyä¸ºæˆ‘ä»¬æœ€åè¦æ±‚å¾—ç»“æœ</p><p>ç„¶åå°±å’Œä¸Šæ–‡æåˆ°çš„ç±»ä¼¼</p><h1 id="åç»­æ“ä½œ"><a href="#åç»­æ“ä½œ" class="headerlink" title="åç»­æ“ä½œ"></a>åç»­æ“ä½œ</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line"></span><br><span class="line">transfer = StandardScaler()</span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line">x_test = transfer.transform(x_test) </span><br><span class="line"><span class="comment"># æ­¤å¤„ä¸èƒ½ç”¨fit_transformï¼Œx_testè¦å’Œtrainåšä¸€æ ·çš„æ“ä½œï¼Œè¦ç”¨trainçš„å¹³å‡å€¼ï¼Œæ‰€ä»¥åªtransformå°±è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4ï¼‰ KNNç®—æ³•é¢„ä¼°å™¨</span></span><br><span class="line">estimator = KNeighborsClassifier(n_neighbors=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å…¥ç½‘æ ¼æœç´¢ä¸äº¤å‰éªŒè¯</span></span><br><span class="line"><span class="comment"># å‚æ•°å‡†å¤‡</span></span><br><span class="line">param_dict = &#123;<span class="string">&quot;n_neighbors&quot;</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]&#125;</span><br><span class="line">estimator = GridSearchCV(estimator, param_grid=param_dict, cv=<span class="number">3</span>)</span><br><span class="line">estimator.fit(x_train,y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5ï¼‰ æ¨¡å‹è¯„ä¼°</span></span><br><span class="line"><span class="comment"># æ³•1: ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼</span></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y_predict: \n&quot;</span>,y_predict)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼: \n&quot;</span>,y_test==y_predict)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³•2: è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">score = estimator.score(x_test,y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å‡†ç¡®ç‡ä¸º: \n&quot;</span>,score)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€ä½³å‚æ•°</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ€ä½³å‚æ•°:\n&quot;</span>, estimator.best_params_)</span><br><span class="line"><span class="comment"># æœ€ä½³ç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ€ä½³ç»“æœ:\n&quot;</span>, estimator.best_score_)</span><br><span class="line"><span class="comment"># æœ€ä½³ä¼°è®¡å™¨</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ€ä½³ä¼°è®¡å™¨:\n&quot;</span>, estimator.best_estimator_)</span><br><span class="line"><span class="comment"># äº¤å‰éªŒè¯ç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;äº¤å‰éªŒè¯ç»“æœ:\n&quot;</span>, estimator.cv_results_)</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/fb_result.png"></p><h1 id="ç»“æœåˆ†æ"><a href="#ç»“æœåˆ†æ" class="headerlink" title="ç»“æœåˆ†æ"></a>ç»“æœåˆ†æ</h1><p>æœ€åå¾—å‡ºçš„å‡†ç¡®ç‡åªæœ‰36%ï¼Œå¯èƒ½ç”±äºxï¼ŒyèŒƒå›´çš„é€‰æ‹©å’Œç‰¹å¾å½±å“çš„åˆ¤å®šæ²¡é‚£ä¹ˆå‡†ç¡®ï¼Œè¿™äº›åœ°æ–¹åº”è¯¥å¯ä»¥ä¼˜åŒ–ï¼Œä¾¿ä¸å†æåŠï¼Œæ•´ä¸ªé¢„æµ‹çš„å¤§è‡´æµç¨‹å°±æ˜¯å¦‚ä¸Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> -æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨å­¦ä¹ _æ¡ˆä¾‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœºå™¨å­¦ä¹ _KNNç®—æ³•</title>
      <link href="/2022/10/05/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_KNN%E7%AE%97%E6%B3%95/"/>
      <url>/2022/10/05/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_KNN%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="æœºå™¨å­¦ä¹ -KNNç®—æ³•"><a href="#æœºå™¨å­¦ä¹ -KNNç®—æ³•" class="headerlink" title="æœºå™¨å­¦ä¹ _KNNç®—æ³•"></a>æœºå™¨å­¦ä¹ _KNNç®—æ³•</h1><h2 id="1ã€K-è¿‘é‚»ç®—æ³•"><a href="#1ã€K-è¿‘é‚»ç®—æ³•" class="headerlink" title="1ã€K-è¿‘é‚»ç®—æ³•"></a>1ã€K-è¿‘é‚»ç®—æ³•</h2><h3 id="1-1-å®šä¹‰-å¦‚æœä¸€ä¸ªæ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„kä¸ªæœ€ç›¸ä¼¼-å³ç‰¹å¾ç©ºé—´ä¸­æœ€é‚»è¿‘-çš„æ ·æœ¬ä¸­çš„å¤§å¤šæ•°å±äºæŸä¸€ä¸ªç±»åˆ«ï¼Œåˆ™è¯¥æ ·æœ¬ä¹Ÿå±äºè¿™ä¸ªç±»åˆ«ã€‚"><a href="#1-1-å®šä¹‰-å¦‚æœä¸€ä¸ªæ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„kä¸ªæœ€ç›¸ä¼¼-å³ç‰¹å¾ç©ºé—´ä¸­æœ€é‚»è¿‘-çš„æ ·æœ¬ä¸­çš„å¤§å¤šæ•°å±äºæŸä¸€ä¸ªç±»åˆ«ï¼Œåˆ™è¯¥æ ·æœ¬ä¹Ÿå±äºè¿™ä¸ªç±»åˆ«ã€‚" class="headerlink" title="1.1 å®šä¹‰:å¦‚æœä¸€ä¸ªæ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„kä¸ªæœ€ç›¸ä¼¼(å³ç‰¹å¾ç©ºé—´ä¸­æœ€é‚»è¿‘)çš„æ ·æœ¬ä¸­çš„å¤§å¤šæ•°å±äºæŸä¸€ä¸ªç±»åˆ«ï¼Œåˆ™è¯¥æ ·æœ¬ä¹Ÿå±äºè¿™ä¸ªç±»åˆ«ã€‚"></a>1.1 å®šä¹‰:å¦‚æœä¸€ä¸ªæ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„<strong>kä¸ªæœ€ç›¸ä¼¼(å³ç‰¹å¾ç©ºé—´ä¸­æœ€é‚»è¿‘)çš„æ ·æœ¬ä¸­çš„å¤§å¤šæ•°å±äºæŸä¸€ä¸ªç±»åˆ«</strong>ï¼Œåˆ™è¯¥æ ·æœ¬ä¹Ÿå±äºè¿™ä¸ªç±»åˆ«ã€‚</h3><h3 id="1-2-è·ç¦»å…¬å¼-ä¸¤ä¸ªæ ·æœ¬çš„å·®è·ä¹Ÿå«è·ç¦»å¯ä»¥é€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼ˆæ¬§å¼å…¬å¼ï¼‰"><a href="#1-2-è·ç¦»å…¬å¼-ä¸¤ä¸ªæ ·æœ¬çš„å·®è·ä¹Ÿå«è·ç¦»å¯ä»¥é€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼ˆæ¬§å¼å…¬å¼ï¼‰" class="headerlink" title="1.2 è·ç¦»å…¬å¼:ä¸¤ä¸ªæ ·æœ¬çš„å·®è·ä¹Ÿå«è·ç¦»å¯ä»¥é€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼ˆæ¬§å¼å…¬å¼ï¼‰:"></a>1.2 è·ç¦»å…¬å¼:ä¸¤ä¸ªæ ·æœ¬çš„å·®è·ä¹Ÿå«è·ç¦»å¯ä»¥é€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼ˆæ¬§å¼å…¬å¼ï¼‰:</h3><p>æ¯”å¦‚A(a1,b1,c1) B(a2,b2.c2)<br>$$<br>\sqrt[]{(a1-a2)^2+(b1-b2)^2+(c1-c2^2)}<br>$$</p><h3 id="ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–å…¬å¼å¯ä»£è¡¨è·ç¦»ï¼Œä¸å”¯ä¸€"><a href="#ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–å…¬å¼å¯ä»£è¡¨è·ç¦»ï¼Œä¸å”¯ä¸€" class="headerlink" title="ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–å…¬å¼å¯ä»£è¡¨è·ç¦»ï¼Œä¸å”¯ä¸€"></a>ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–å…¬å¼å¯ä»£è¡¨è·ç¦»ï¼Œä¸å”¯ä¸€</h3><h3 id="1-3-K-è¿‘é‚»ç®—æ³•API"><a href="#1-3-K-è¿‘é‚»ç®—æ³•API" class="headerlink" title="1.3 K-è¿‘é‚»ç®—æ³•API"></a>1.3 K-è¿‘é‚»ç®—æ³•API</h3><ul><li>sklearn.neighbors.KNeighborsClassifier(n_neighbors=5,algorithm=â€™autoâ€™)<ul><li>n_neighborsï¼šint,å¯é€‰ï¼ˆé»˜è®¤= 5ï¼‰ï¼Œk_neighborsæŸ¥è¯¢é»˜è®¤ä½¿ç”¨çš„é‚»å±…æ•°</li><li>algorithmï¼š{â€˜autoâ€™ï¼Œâ€˜ball_treeâ€™ï¼Œâ€˜kd_treeâ€™ï¼Œâ€˜bruteâ€™}ï¼Œå¯é€‰ç”¨äºè®¡ç®—æœ€è¿‘é‚»å±…çš„ç®—æ³•ï¼šâ€˜ball_treeâ€™å°†ä¼šä½¿ç”¨ BallTreeï¼Œâ€˜kd_treeâ€™å°†ä½¿ç”¨ KDTreeã€‚â€˜autoâ€™å°†å°è¯•æ ¹æ®ä¼ é€’ç»™fitæ–¹æ³•çš„å€¼æ¥å†³å®šæœ€åˆé€‚çš„ç®—æ³•ã€‚ (ä¸åŒå®ç°æ–¹å¼å½±å“æ•ˆç‡)</li></ul></li></ul><h1 id="åŸºäºé¸¢å°¾èŠ±æ•°æ®é›†çš„æµ‹è¯•"><a href="#åŸºäºé¸¢å°¾èŠ±æ•°æ®é›†çš„æµ‹è¯•" class="headerlink" title="åŸºäºé¸¢å°¾èŠ±æ•°æ®é›†çš„æµ‹è¯•"></a>åŸºäºé¸¢å°¾èŠ±æ•°æ®é›†çš„æµ‹è¯•</h1><ol><li><p>è·å–æ•°æ®</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iris = load_iris()</span><br></pre></td></tr></table></figure></li><li><p>åˆ’åˆ†æ•°æ®é›†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x_train, x_test, y_train, y_test = train_test_split(iris.data, iris.target,test_size=<span class="number">0.3</span>, random_state=<span class="number">6</span>)</span><br></pre></td></tr></table></figure><p>å°†é¸¢å°¾èŠ±æ•°æ®åˆ†ä¸ºè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ï¼Œæµ‹è¯•æ•°æ®ç”¨äºä¹‹åçš„å‡†ç¡®æ€§åˆ¤æ–­</p></li><li><p>ç‰¹å¾å·¥ç¨‹ï¼šæ ‡å‡†åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">transfer = StandardScaler()</span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line">x_test = transfer.transform(x_test) <span class="comment"># æ­¤å¤„ä¸èƒ½ç”¨fit_transformï¼Œx_testè¦å’Œtrainåšä¸€æ ·çš„æ“ä½œï¼Œè¦ç”¨trainçš„å¹³å‡å€¼ï¼Œæ‰€ä»¥åªtransformå°±è¡Œ</span></span><br></pre></td></tr></table></figure></li><li><p>KNNç®—æ³•é¢„ä¼°å™¨</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">estimator = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br><span class="line">estimator.fit(x_train,y_train)</span><br></pre></td></tr></table></figure><p>å°†Kå€¼è®¾ä¸º3ï¼Œå³å½“å‰æ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„3ä¸ªæœ€ç›¸ä¼¼(ç‰¹å¾ç©ºé—´ä¸­è·ç¦»æœ€è¿‘)çš„æ ·æœ¬å¤§å¤šéƒ½å±äºåŒä¸€ç±»åˆ«ï¼Œåˆ™è¯¥æ ·æœ¬ä¹Ÿå±äºåŒä¸€ç±»åˆ«</p></li><li><p>æ¨¡å‹è¯„ä¼°</p><ol><li><p>ç›´æ¥å¯¹æ¯”çœŸå®å€¼å’Œé¢„æµ‹å€¼</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">y.predict = estimator.predict(x_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y_predict: \n&quot;</span>,y_predict)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼: \n&quot;</span>,y_test==y_predict) </span><br></pre></td></tr></table></figure></li></ol></li></ol><p><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E9%B8%A2%E5%B0%BE%E8%8A%B1_%E7%BB%93%E6%9E%9C.png"></p><ol start="2"><li><p>è®¡ç®—å‡†ç¡®ç‡</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">score = estimator.score(x_test,y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å‡†ç¡®ç‡ä¸º: \n&quot;</span>,score)</span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/æœºå™¨å­¦ä¹ _é¸¢å°¾èŠ±_å‡†ç¡®ç‡.png" style="zoom:200%;" /><ol start="3"><li>å½“test_sizeçš„å€¼å˜åŒ–æ—¶ï¼Œå‡†ç¡®ç‡ä¹Ÿä¼šå˜åŒ–ã€‚kå€¼å˜åŒ–ï¼Œå‡†ç¡®ç‡ä¹Ÿä¼šéšä¹‹å˜åŒ–ï¼Œk=3æ—¶ï¼Œå‡†ç¡®ç‡=93.3%ï¼Œk=4æ—¶ï¼Œå‡†ç¡®ç‡=91%ï¼Œk=5æ—¶ï¼Œä¸º95.6%ï¼Œä½†ä¸æ˜¯çº¿æ€§å˜åŒ–ã€‚</li></ol></li></ol><h1 id="ç»“æœåˆ†æ"><a href="#ç»“æœåˆ†æ" class="headerlink" title="ç»“æœåˆ†æ"></a>ç»“æœåˆ†æ</h1><h2 id="kå€¼å¤§å°å¯¹æ•°æ®çš„å½±å“"><a href="#kå€¼å¤§å°å¯¹æ•°æ®çš„å½±å“" class="headerlink" title="kå€¼å¤§å°å¯¹æ•°æ®çš„å½±å“:"></a>kå€¼å¤§å°å¯¹æ•°æ®çš„å½±å“:</h2><p>kå€¼å–å¾ˆå°ï¼šå®¹æ˜“å—åˆ°å¼‚å¸¸ç‚¹çš„å½±å“</p><p>kå€¼å–å¾ˆå¤§ï¼šå—åˆ°æ ·æœ¬å‡è¡¡çš„é—®é¢˜</p><p>æ€§èƒ½é—®é¢˜:è®¡ç®—è·ç¦»æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦è¾ƒé«˜</p><h1 id="äº¤å‰éªŒè¯ï¼Œæ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜"><a href="#äº¤å‰éªŒè¯ï¼Œæ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜" class="headerlink" title="äº¤å‰éªŒè¯ï¼Œæ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜"></a>äº¤å‰éªŒè¯ï¼Œæ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜</h1><h2 id="ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯-cross-validation"><a href="#ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯-cross-validation" class="headerlink" title="ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯(cross validation)"></a>ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯(cross validation)</h2><p>äº¤å‰éªŒè¯ï¼šå°†æ‹¿åˆ°çš„è®­ç»ƒæ•°æ®ï¼Œåˆ†ä¸ºè®­ç»ƒå’ŒéªŒè¯é›†ã€‚ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼šå°†æ•°æ®åˆ†æˆ5ä»½ï¼Œå…¶ä¸­ä¸€ä»½ä½œä¸ºéªŒè¯é›†ã€‚ç„¶åç»è¿‡5æ¬¡(ç»„)çš„æµ‹è¯•ï¼Œæ¯æ¬¡éƒ½æ›´æ¢ä¸åŒçš„éªŒè¯é›†ã€‚å³å¾—åˆ°5ç»„æ¨¡å‹çš„ç»“æœï¼Œå–å¹³å‡å€¼ä½œä¸ºæœ€ç»ˆç»“æœã€‚åˆç§°5æŠ˜äº¤å‰éªŒè¯ã€‚</p><h2 id="æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜"><a href="#æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜" class="headerlink" title="æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜"></a>æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜</h2><ul><li>sklearn.model_selection.GridSearchCV(estimator, param_grid=None,cv=None)<ul><li>å¯¹ä¼°è®¡å™¨çš„æŒ‡å®šå‚æ•°å€¼è¿›è¡Œè¯¦å°½æœç´¢</li><li>estimatorï¼šä¼°è®¡å™¨å¯¹è±¡</li><li>param_gridï¼šä¼°è®¡å™¨å‚æ•°(dict){â€œn_neighborsâ€:[1,3,5]}</li><li>cvï¼šæŒ‡å®šå‡ æŠ˜äº¤å‰éªŒè¯</li><li>fitï¼šè¾“å…¥è®­ç»ƒæ•°æ®</li><li>scoreï¼šå‡†ç¡®ç‡</li><li>ç»“æœåˆ†æï¼š<ul><li>best<em>score</em>:åœ¨äº¤å‰éªŒè¯ä¸­éªŒè¯çš„æœ€å¥½ç»“æœ_</li><li>best<em>estimator</em>ï¼šæœ€å¥½çš„å‚æ•°æ¨¡å‹</li><li>cv<em>results</em>:æ¯æ¬¡äº¤å‰éªŒè¯åçš„éªŒè¯é›†å‡†ç¡®ç‡ç»“æœå’Œè®­ç»ƒé›†å‡†ç¡®ç‡ç»“æœ</li></ul></li></ul></li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">param_dict = &#123;<span class="string">&quot;n_neighbors&quot;</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>]&#125;</span><br><span class="line">estimator = GridSearchCV(estimator, param_grid=param_dict, cv=<span class="number">10</span>) <span class="comment"># æ•°æ®è¿‡å¤§æ—¶cvéœ€å‡å°</span></span><br><span class="line">estimator.fit(x_train,y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€ä½³å‚æ•°</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ€ä½³å‚æ•°:\n&quot;</span>, estimator.best_params_)</span><br><span class="line"><span class="comment"># æœ€ä½³ç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ€ä½³ç»“æœ:\n&quot;</span>, estimator.best_score_)</span><br><span class="line"><span class="comment"># æœ€ä½³ä¼°è®¡å™¨</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ€ä½³ä¼°è®¡å™¨:\n&quot;</span>, estimator.best_estimator_)</span><br><span class="line"><span class="comment"># äº¤å‰éªŒè¯ç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;äº¤å‰éªŒè¯ç»“æœ:\n&quot;</span>, estimator.cv_results_)</span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/bibabu01/blog_img/é¸¢å°¾èŠ±_æ¨¡å‹é€‰æ‹©è°ƒä¼˜.png" style="zoom:150%;" /><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li><p>ä¼˜ç‚¹ï¼š</p><ul><li>ç®€å•ï¼Œæ˜“äºç†è§£ï¼Œæ˜“äºå®ç°ï¼Œæ— éœ€è®­ç»ƒ</li></ul></li><li><p>ç¼ºç‚¹ï¼š</p><ul><li>æ‡’æƒ°ç®—æ³•ï¼Œå¯¹æµ‹è¯•æ ·æœ¬åˆ†ç±»æ—¶çš„è®¡ç®—é‡å¤§ï¼Œå†…å­˜å¼€é”€å¤§</li><li>å¿…é¡»æŒ‡å®šKå€¼ï¼ŒKå€¼é€‰æ‹©ä¸å½“åˆ™åˆ†ç±»ç²¾åº¦ä¸èƒ½ä¿è¯</li></ul></li><li><p>ä½¿ç”¨åœºæ™¯ï¼šå°æ•°æ®åœºæ™¯ï¼Œå‡ åƒï½å‡ ä¸‡æ ·æœ¬ï¼Œå…·ä½“åœºæ™¯å…·ä½“ä¸šåŠ¡å»æµ‹è¯•</p></li></ul><p>psï¼šæœ¬æ–‡éƒ¨åˆ†å†…å®¹æ‘˜è‡ªGitBook</p>]]></content>
      
      
      <categories>
          
          <category> -æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨å­¦ä¹ _ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åšå®¢ä»‹ç»</title>
      <link href="/2022/10/02/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2022/10/02/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="å»ºç«™ç›®çš„"><a href="#å»ºç«™ç›®çš„" class="headerlink" title="å»ºç«™ç›®çš„"></a>å»ºç«™ç›®çš„</h1><p>æœ¬ç«™å»ºç«‹äº2022å¹´10æœˆ3æ—¥ï¼Œç¬”è€…å¸Œæœ›é€šè¿‡ç¼–å†™æ­¤åšå®¢ç£ä¿ƒè‡ªå·±çš„å­¦ä¹ ï¼ŒåŒæ—¶è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½å’Œæ„Ÿæ‚Ÿ</p><h1 id="åšå®¢åˆ†ç±»"><a href="#åšå®¢åˆ†ç±»" class="headerlink" title="åšå®¢åˆ†ç±»"></a>åšå®¢åˆ†ç±»</h1><p>åšå®¢å¤§è‡´ä¼šä»¥è®°å½•å­¦ä¹ ä¸ºä¸»ï¼Œè®°å½•ç”Ÿæ´»å’Œæ„Ÿæ‚Ÿä¸ºè¾…ã€‚å—¯â€¦åº”è¯¥æ²¡äº†ğŸ¥°</p>]]></content>
      
      
      <categories>
          
          <category> æœ¬ç«™ä»‹ç» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»‹ç» </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
